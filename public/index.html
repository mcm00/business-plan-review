<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#4f46e5">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; font-src 'self' https://fonts.gstatic.com; script-src 'self' 'unsafe-inline'; img-src 'self' data: https:; connect-src 'self'; frame-src 'none'; object-src 'none';">
    <title>Business Plan Review</title>
    <link rel="apple-touch-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ðŸ“‹</text></svg>">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="app">
        <!-- Header -->
        <header class="header">
            <div class="header-left">
                <button class="btn-icon menu-toggle" id="menu-toggle" aria-label="Toggle menu">
                    <svg width="24" height="24" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
                    </svg>
                </button>
                <h1 class="header-title">Business Plan Review</h1>
            </div>
            <div class="header-right">
                <button class="btn-icon notification-btn" id="notification-btn" aria-label="Notifications">
                    <svg width="24" height="24" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"/>
                    </svg>
                    <span class="notification-badge" id="notification-badge">0</span>
                </button>
                <div class="user-switcher">
                    <div class="avatar" id="current-avatar">F</div>
                    <select id="current-user" class="user-select">
                        <option value="Francisco">Francisco</option>
                        <option value="Wife">Wife</option>
                    </select>
                </div>
                <button class="btn-icon" id="logout-btn" aria-label="Logout" title="Logout" onclick="logout()">
                    <svg width="24" height="24" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"/>
                    </svg>
                </button>
            </div>
        </header>

        <div class="main-layout">
            <!-- Sidebar -->
            <nav class="sidebar" id="sidebar">
                <div class="sidebar-header">
                    <h2>Sections</h2>
                </div>
                <ul class="nav-list" id="nav-list"></ul>
                <div class="sidebar-stats" id="sidebar-stats"></div>
            </nav>

            <!-- Overlay for mobile -->
            <div class="sidebar-overlay" id="sidebar-overlay"></div>

            <!-- Main Content -->
            <main class="main-content" id="main-content">
                <div class="loading" id="loading">
                    <div class="spinner"></div>
                    <p>Loading business plan...</p>
                </div>
                <div class="sections-container" id="sections-container"></div>
            </main>

            <!-- Discussion Panel -->
            <aside class="panel" id="panel">
                <div class="panel-header">
                    <div class="panel-title-row">
                        <h2>Discussion</h2>
                        <button class="btn-icon panel-close" id="panel-close">
                            <svg width="24" height="24" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                            </svg>
                        </button>
                    </div>
                    <div class="panel-filters" id="panel-filters">
                        <button class="filter-chip active" data-filter="all">All</button>
                        <button class="filter-chip" data-filter="comments">Comments</button>
                        <button class="filter-chip" data-filter="questions">Questions</button>
                        <button class="filter-chip" data-filter="pending">Pending</button>
                        <button class="filter-chip" data-filter="resolved">Resolved</button>
                    </div>
                </div>
                <div class="panel-body">
                    <div class="discussion-list" id="discussion-list"></div>
                </div>
                <div class="panel-footer">
                    <form class="add-form" id="add-form">
                        <div class="form-type-row">
                            <label class="radio-label">
                                <input type="radio" name="type" value="comment" checked>
                                <span class="radio-text">Comment</span>
                            </label>
                            <label class="radio-label">
                                <input type="radio" name="type" value="question">
                                <span class="radio-text">Question</span>
                            </label>
                        </div>
                        <select class="section-select" id="section-select">
                            <option value="">General</option>
                        </select>
                        <div class="input-row">
                            <textarea class="form-textarea" id="form-textarea" placeholder="Add comment or question..." rows="2"></textarea>
                            <button type="submit" class="btn-submit">
                                <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"/>
                                </svg>
                            </button>
                        </div>
                    </form>
                </div>
            </aside>
        </div>

        <!-- FAB for mobile -->
        <button class="fab" id="fab" aria-label="Open discussion panel">
            <svg width="24" height="24" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"/>
            </svg>
            <span class="fab-badge" id="fab-badge">0</span>
        </button>

        <!-- Notification Panel -->
        <div class="notification-panel" id="notification-panel">
            <div class="notification-header">
                <h3>Notifications</h3>
                <button class="btn-text" id="mark-all-read">Mark all read</button>
            </div>
            <div class="notification-list" id="notification-list"></div>
        </div>
    </div>

    <!-- Toast -->
    <div class="toast" id="toast"></div>

    <script src="app.js"></script>
</body>
</html>
